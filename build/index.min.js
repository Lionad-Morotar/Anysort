!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(r="undefined"!=typeof globalThis?globalThis:r||self).module=e()}(this,(function(){"use strict";const r=r=>"development"===process.env.NODE_ENV&&console.log(`[WARN] ${r}`),e=r=>(r=>null==r)(r)?"void":Object.prototype.toString.call(r).slice(8,-1).toLowerCase(),t=r=>!!r,n={delim:"-",patched:"__ANYSORT_PATCHED__",autoWrap:!0,autoSort:!0,orders:{number:1,string:2,symbol:3,date:4,object:5,function:6,rest:7,void:8}},o={void:r=>null,number:Number,string:String,symbol:r=>r.toString(),date:r=>+r,function:r=>r.name,boolean:r=>!r},i=(t,i)=>{const s=e(t),a=e(i),l=n.orders,u=l[s]||l.rest,p=l[a]||l.rest;if(u&&p)return u===p?((e,t,n)=>{const i=o[e];if(i){const r=i(t),e=i(n);return r===e?0:r<e?-1:1}r(`cant sort ${t} and ${n}，skip by default`)})(s,t,i):((r,e)=>r-e<0?-1:1)(u,p);r(`cant sort ${t} and ${i}，skip by default`)};class s{constructor(){this.pipeline=[]}register(r,e){r(this,e)}map(r){return this.pipeline.push({_value:r,_type:"maping"}),this}result(r){return this.pipeline.push({_value:r,_type:"result"}),this}seal(){let r=i;return this.pipeline.reverse().map((e=>{const{_type:t,_value:n}=e;var o,i;"maping"===t&&(r=(o=n,r=>(e,t)=>r(o(e),o(t)))(r)),"result"===t&&(r=(i=n,r=>(e,t)=>i(r(e,t)))(r))})),r}}const a={i:r=>r.map((r=>{if("string"==typeof r)return r.toLowerCase();throw new Error('[ANYSORT] "i" plugin only works on string')})),is:(r,e)=>{if(""!==e)return r.map((r=>r===e));throw new Error('[ANYSORT] "is" plugin needs an arg')},nth:(r,e)=>{if(""!==e)return r.map((r=>{if(r instanceof Array)return r[+e];if("string"==typeof r)return r[+e];throw new Error('[ANYSORT] "nth" plugin only works on string or array')}));throw new Error('[ANYSORT] "nth" plugin need an arg')},all:(r,e)=>r.map((r=>{if(""!==e){if(r instanceof Array)return r.every((r=>String(r)===e));if("string"==typeof r)return r===e;throw new Error('[ANYSORT] "all" plugin only works on string or array')}throw new Error('[ANYSORT] "all" plugin need an arg')})),has:(r,e)=>r.map((r=>{if(""!==e){if(r instanceof Array)return r.some((r=>String(r)===e));if("string"==typeof r)return r.includes(e);throw new Error('[ANYSORT] "has" plugin only works on string or array')}throw new Error('[ANYSORT] "has" plugin need an arg')})),not:(r,e="")=>""!==e?r.map((r=>r!==e)):r.map((r=>!r)),len:(r,e)=>""!==e?r.map((r=>{if(r instanceof Array)return r.length===+e;if("string"==typeof r)return r.length===+e;throw new Error('[ANYSORT] "len" plugin only works on string or array')})):r.map((r=>{if(r instanceof Array)return r.length;if("string"==typeof r)return r.length;throw new Error('[ANYSORT] "len" plugin only works on string or array')})),get:(e,t)=>{if(""!==t)return e.map((n=t,e=>{const t=n instanceof Array?n.slice(0,n.length):n.split(".");let o=e,i=null;for(;o&&t.length;)i=t.shift(),Object.prototype.hasOwnProperty.call(o,i)||r(`cant find path "${JSON.stringify(n)}" in ${s=e,JSON.stringify(s)}, skip by default`),o=o[i];var s;return o}));throw new Error('[ANYSORT] "get" plugin must have a string argument');var n},reverse:r=>r.result((r=>-r)),rand:r=>r.result((r=>Math.random()<.5?-1:1)),result:r=>r.result((r=>r))};function l(r){if(r[n.patched])throw new Error("[ANYSORT] patched arr cant be wrapped again");let e=null;const t=[];return e=new Proxy(r,{get(r,o){switch(o){case n.patched:return!0;case"apply":return(...e)=>u(r,...e);default:return Object.prototype.hasOwnProperty.call(a,o)?(e="")=>{const n=`${[t.splice(0,t.length).join("."),o].join("-")}(${String(e)})`;return u(r,n)}:o in r?r[o]:o.includes("_")?(e="")=>{const n=`${[t.splice(0,t.length).join("."),o].join("-").replace("_","()-")}(${String(e)})`;return u(r,n)}:(t.push(o),e)}}})}const u=(r,...o)=>{const i=o.reduce(((r,e)=>r.concat(e)),[]).filter(Boolean),u=0===i.length;if(u&&!n.autoSort)return n.autoWrap?l(r):r;const p=u?[(new s).seal()]:i.map(((r,o)=>(r=>"function"===e(r))(r)?r:function(r){const e=new s;return r.split(n.delim).filter(t).map((t=>{const n=t.match(/^([^(]+)(\(([^)]*)\))?$/);if(!n)throw new Error(`[ANYSORT] illegal command: ${r}`);{const[,r,t,o]=n;t?e.register(a[r],o):e.register(a.get,r)}})),e.seal()}(r))),c=(g=p,(r,e)=>g.reduce(((t,n)=>t||n(r,e)),0));var g;let f=r.sort(c);return n.autoWrap&&(f[n.patched]||(f=l(f))),f};return u.extends=r=>(Object.entries(r).map((([r,e])=>a[r]=e)),u),u.wrap=r=>l(r),u.config=n,u}));
//# sourceMappingURL=index.min.js.map
